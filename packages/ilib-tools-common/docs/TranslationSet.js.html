<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>TranslationSet.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="CSharpEscaper.html">CSharpEscaper</a><ul class='methods'><li data-type='method'><a href="CSharpEscaper.html#escape">escape</a></li><li data-type='method'><a href="CSharpEscaper.html#unescape">unescape</a></li></ul></li><li><a href="Escaper.html">Escaper</a><ul class='methods'><li data-type='method'><a href="Escaper.html#escape">escape</a></li><li data-type='method'><a href="Escaper.html#getDescription">getDescription</a></li><li data-type='method'><a href="Escaper.html#getName">getName</a></li><li data-type='method'><a href="Escaper.html#getStyle">getStyle</a></li><li data-type='method'><a href="Escaper.html#unescape">unescape</a></li></ul></li><li><a href="JavaEscaper.html">JavaEscaper</a><ul class='methods'><li data-type='method'><a href="JavaEscaper.html#escape">escape</a></li><li data-type='method'><a href="JavaEscaper.html#unescape">unescape</a></li></ul></li><li><a href="JavascriptEscaper.html">JavascriptEscaper</a><ul class='methods'><li data-type='method'><a href="JavascriptEscaper.html#escape">escape</a></li><li data-type='method'><a href="JavascriptEscaper.html#unescape">unescape</a></li></ul></li><li><a href="JsonEscaper.html">JsonEscaper</a><ul class='methods'><li data-type='method'><a href="JsonEscaper.html#escape">escape</a></li><li data-type='method'><a href="JsonEscaper.html#unescape">unescape</a></li></ul></li><li><a href="Location.html">Location</a><ul class='methods'><li data-type='method'><a href="Location.html#getLocation">getLocation</a></li></ul></li><li><a href="PHPEscaper.html">PHPEscaper</a><ul class='methods'><li data-type='method'><a href="PHPEscaper.html#escape">escape</a></li><li data-type='method'><a href="PHPEscaper.html#unescape">unescape</a></li></ul></li><li><a href="PythonEscaper.html">PythonEscaper</a><ul class='methods'><li data-type='method'><a href="PythonEscaper.html#escape">escape</a></li><li data-type='method'><a href="PythonEscaper.html#unescape">unescape</a></li></ul></li><li><a href="RegexBasedEscaper.html">RegexBasedEscaper</a><ul class='methods'><li data-type='method'><a href="RegexBasedEscaper.html#escape">escape</a></li><li data-type='method'><a href="RegexBasedEscaper.html#unescape">unescape</a></li></ul></li><li><a href="Resource.html">Resource</a><ul class='methods'><li data-type='method'><a href="Resource.html#addInstance">addInstance</a></li><li data-type='method'><a href="Resource.html#clearDirty">clearDirty</a></li><li data-type='method'><a href="Resource.html#escapeText">escapeText</a></li><li data-type='method'><a href="Resource.html#getAutoKey">getAutoKey</a></li><li data-type='method'><a href="Resource.html#getComment">getComment</a></li><li data-type='method'><a href="Resource.html#getContext">getContext</a></li><li data-type='method'><a href="Resource.html#getDNT">getDNT</a></li><li data-type='method'><a href="Resource.html#getDataType">getDataType</a></li><li data-type='method'><a href="Resource.html#getFlavor">getFlavor</a></li><li data-type='method'><a href="Resource.html#getId">getId</a></li><li data-type='method'><a href="Resource.html#getInstances">getInstances</a></li><li data-type='method'><a href="Resource.html#getKey">getKey</a></li><li data-type='method'><a href="Resource.html#getLocalize">getLocalize</a></li><li data-type='method'><a href="Resource.html#getLocation">getLocation</a></li><li data-type='method'><a href="Resource.html#getOrigin">getOrigin</a></li><li data-type='method'><a href="Resource.html#getPath">getPath</a></li><li data-type='method'><a href="Resource.html#getProject">getProject</a></li><li data-type='method'><a href="Resource.html#getSource">getSource</a></li><li data-type='method'><a href="Resource.html#getSourceLocale">getSourceLocale</a></li><li data-type='method'><a href="Resource.html#getState">getState</a></li><li data-type='method'><a href="Resource.html#getTarget">getTarget</a></li><li data-type='method'><a href="Resource.html#getTargetLocale">getTargetLocale</a></li><li data-type='method'><a href="Resource.html#getType">getType</a></li><li data-type='method'><a href="Resource.html#isDirty">isDirty</a></li><li data-type='method'><a href="Resource.html#isInstance">isInstance</a></li><li data-type='method'><a href="Resource.html#same">same</a></li><li data-type='method'><a href="Resource.html#setComment">setComment</a></li><li data-type='method'><a href="Resource.html#setDNT">setDNT</a></li><li data-type='method'><a href="Resource.html#setProject">setProject</a></li><li data-type='method'><a href="Resource.html#setSourceLocale">setSourceLocale</a></li><li data-type='method'><a href="Resource.html#setState">setState</a></li><li data-type='method'><a href="Resource.html#setTargetLocale">setTargetLocale</a></li></ul></li><li><a href="ResourceArray.html">ResourceArray</a><ul class='methods'><li data-type='method'><a href="ResourceArray.html#addSourceItem">addSourceItem</a></li><li data-type='method'><a href="ResourceArray.html#addTargetItem">addTargetItem</a></li><li data-type='method'><a href="ResourceArray.html#cleanHashKey">cleanHashKey</a></li><li data-type='method'><a href="ResourceArray.html#cleanHashKeyForTranslation">cleanHashKeyForTranslation</a></li><li data-type='method'><a href="ResourceArray.html#clone">clone</a></li><li data-type='method'><a href="ResourceArray.html#equals">equals</a></li><li data-type='method'><a href="ResourceArray.html#equals">equals</a></li><li data-type='method'><a href="ResourceArray.html#getSourceArray">getSourceArray</a></li><li data-type='method'><a href="ResourceArray.html#getSourceItem">getSourceItem</a></li><li data-type='method'><a href="ResourceArray.html#getTargetArray">getTargetArray</a></li><li data-type='method'><a href="ResourceArray.html#getTargetItem">getTargetItem</a></li><li data-type='method'><a href="ResourceArray.html#hashKey">hashKey</a></li><li data-type='method'><a href="ResourceArray.html#hashKeyForTranslation">hashKeyForTranslation</a></li><li data-type='method'><a href="ResourceArray.html#isInstance">isInstance</a></li><li data-type='method'><a href="ResourceArray.html#setSource">setSource</a></li><li data-type='method'><a href="ResourceArray.html#setTarget">setTarget</a></li><li data-type='method'><a href="ResourceArray.html#size">size</a></li><li data-type='method'><a href="ResourceArray.html#.hashKey">hashKey</a></li></ul></li><li><a href="ResourcePlural.html">ResourcePlural</a><ul class='methods'><li data-type='method'><a href="ResourcePlural.html#addSourcePlural">addSourcePlural</a></li><li data-type='method'><a href="ResourcePlural.html#addTargetPlural">addTargetPlural</a></li><li data-type='method'><a href="ResourcePlural.html#cleanHashKey">cleanHashKey</a></li><li data-type='method'><a href="ResourcePlural.html#cleanHashKeyForTranslation">cleanHashKeyForTranslation</a></li><li data-type='method'><a href="ResourcePlural.html#clone">clone</a></li><li data-type='method'><a href="ResourcePlural.html#equals">equals</a></li><li data-type='method'><a href="ResourcePlural.html#getAllValidCategories">getAllValidCategories</a></li><li data-type='method'><a href="ResourcePlural.html#getCategories">getCategories</a></li><li data-type='method'><a href="ResourcePlural.html#getClasses">getClasses</a></li><li data-type='method'><a href="ResourcePlural.html#getPivots">getPivots</a></li><li data-type='method'><a href="ResourcePlural.html#getSourcePlural">getSourcePlural</a></li><li data-type='method'><a href="ResourcePlural.html#getSourcePlurals">getSourcePlurals</a></li><li data-type='method'><a href="ResourcePlural.html#getSourceStrings">getSourceStrings</a></li><li data-type='method'><a href="ResourcePlural.html#getTargetPlural">getTargetPlural</a></li><li data-type='method'><a href="ResourcePlural.html#getTargetPlurals">getTargetPlurals</a></li><li data-type='method'><a href="ResourcePlural.html#getTargetStrings">getTargetStrings</a></li><li data-type='method'><a href="ResourcePlural.html#hashKey">hashKey</a></li><li data-type='method'><a href="ResourcePlural.html#hashKeyForTranslation">hashKeyForTranslation</a></li><li data-type='method'><a href="ResourcePlural.html#isInstance">isInstance</a></li><li data-type='method'><a href="ResourcePlural.html#setSource">setSource</a></li><li data-type='method'><a href="ResourcePlural.html#setTarget">setTarget</a></li><li data-type='method'><a href="ResourcePlural.html#size">size</a></li><li data-type='method'><a href="ResourcePlural.html#.hashKey">hashKey</a></li></ul></li><li><a href="ResourceString.html">ResourceString</a><ul class='methods'><li data-type='method'><a href="ResourceString.html#cleanHashKey">cleanHashKey</a></li><li data-type='method'><a href="ResourceString.html#cleanHashKeyForTranslation">cleanHashKeyForTranslation</a></li><li data-type='method'><a href="ResourceString.html#clone">clone</a></li><li data-type='method'><a href="ResourceString.html#equals">equals</a></li><li data-type='method'><a href="ResourceString.html#hashKey">hashKey</a></li><li data-type='method'><a href="ResourceString.html#hashKeyForTranslation">hashKeyForTranslation</a></li><li data-type='method'><a href="ResourceString.html#isInstance">isInstance</a></li><li data-type='method'><a href="ResourceString.html#setSource">setSource</a></li><li data-type='method'><a href="ResourceString.html#setTarget">setTarget</a></li><li data-type='method'><a href="ResourceString.html#size">size</a></li><li data-type='method'><a href="ResourceString.html#.cleanHashKey">cleanHashKey</a></li><li data-type='method'><a href="ResourceString.html#.hashKey">hashKey</a></li></ul></li><li><a href="ResourceXliff.html">ResourceXliff</a><ul class='methods'><li data-type='method'><a href="ResourceXliff.html#getLines">getLines</a></li><li data-type='method'><a href="ResourceXliff.html#getVersion">getVersion</a></li><li data-type='method'><a href="ResourceXliff.html#size">size</a></li></ul></li><li><a href="SmartyEscaper.html">SmartyEscaper</a><ul class='methods'><li data-type='method'><a href="SmartyEscaper.html#escape">escape</a></li><li data-type='method'><a href="SmartyEscaper.html#unescape">unescape</a></li></ul></li><li><a href="SwiftEscaper.html">SwiftEscaper</a><ul class='methods'><li data-type='method'><a href="SwiftEscaper.html#escape">escape</a></li><li data-type='method'><a href="SwiftEscaper.html#unescape">unescape</a></li></ul></li><li><a href="TranslationSet.html">TranslationSet</a><ul class='methods'><li data-type='method'><a href="TranslationSet.html#add">add</a></li><li data-type='method'><a href="TranslationSet.html#addAll">addAll</a></li><li data-type='method'><a href="TranslationSet.html#addSet">addSet</a></li><li data-type='method'><a href="TranslationSet.html#clear">clear</a></li><li data-type='method'><a href="TranslationSet.html#diff">diff</a></li><li data-type='method'><a href="TranslationSet.html#get">get</a></li><li data-type='method'><a href="TranslationSet.html#getAll">getAll</a></li><li data-type='method'><a href="TranslationSet.html#getBy">getBy</a></li><li data-type='method'><a href="TranslationSet.html#getBySource">getBySource</a></li><li data-type='method'><a href="TranslationSet.html#getClean">getClean</a></li><li data-type='method'><a href="TranslationSet.html#getContexts">getContexts</a></li><li data-type='method'><a href="TranslationSet.html#getLocales">getLocales</a></li><li data-type='method'><a href="TranslationSet.html#getProjects">getProjects</a></li><li data-type='method'><a href="TranslationSet.html#isDirty">isDirty</a></li><li data-type='method'><a href="TranslationSet.html#remove">remove</a></li><li data-type='method'><a href="TranslationSet.html#setClean">setClean</a></li><li data-type='method'><a href="TranslationSet.html#size">size</a></li></ul></li><li><a href="TranslationUnit.html">TranslationUnit</a><ul class='methods'><li data-type='method'><a href="TranslationUnit.html#addProperties">addProperties</a></li><li data-type='method'><a href="TranslationUnit.html#addVariant">addVariant</a></li><li data-type='method'><a href="TranslationUnit.html#addVariants">addVariants</a></li><li data-type='method'><a href="TranslationUnit.html#clone">clone</a></li><li data-type='method'><a href="TranslationUnit.html#getProperties">getProperties</a></li><li data-type='method'><a href="TranslationUnit.html#getVariants">getVariants</a></li><li data-type='method'><a href="TranslationUnit.html#hashKey">hashKey</a></li></ul></li><li><a href="TranslationVariant.html">TranslationVariant</a><ul class='methods'><li data-type='method'><a href="TranslationVariant.html#hashKey">hashKey</a></li></ul></li><li><a href="URIEscaper.html">URIEscaper</a><ul class='methods'><li data-type='method'><a href="URIEscaper.html#escape">escape</a></li><li data-type='method'><a href="URIEscaper.html#unescape">unescape</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#cleanString">cleanString</a></li><li><a href="global.html#containsActualText">containsActualText</a></li><li><a href="global.html#convertICUToPluralRes">convertICUToPluralRes</a></li><li><a href="global.html#convertPluralResToICU">convertPluralResToICU</a></li><li><a href="global.html#escapeHex">escapeHex</a></li><li><a href="global.html#escapeRules">escapeRules</a></li><li><a href="global.html#escapeUnicode">escapeUnicode</a></li><li><a href="global.html#escapeUnicodeAsSurrogatePairs">escapeUnicodeAsSurrogatePairs</a></li><li><a href="global.html#escapeUnicodeAstral">escapeUnicodeAstral</a></li><li><a href="global.html#escapeUnicodeExtended">escapeUnicodeExtended</a></li><li><a href="global.html#escapeUnicodeWithBrackets">escapeUnicodeWithBrackets</a></li><li><a href="global.html#escaperFactory">escaperFactory</a></li><li><a href="global.html#formatPath">formatPath</a></li><li><a href="global.html#getLocaleFromPath">getLocaleFromPath</a></li><li><a href="global.html#hashKey">hashKey</a></li><li><a href="global.html#ignoreTags">ignoreTags</a></li><li><a href="global.html#isEmpty">isEmpty</a></li><li><a href="global.html#localizableAttributes">localizableAttributes</a></li><li><a href="global.html#nonBreakingTags">nonBreakingTags</a></li><li><a href="global.html#objectMap">objectMap</a></li><li><a href="global.html#parsePath">parsePath</a></li><li><a href="global.html#selfClosingTags">selfClosingTags</a></li><li><a href="global.html#unescapeHex">unescapeHex</a></li><li><a href="global.html#unescapeOctal">unescapeOctal</a></li><li><a href="global.html#unescapeRules">unescapeRules</a></li><li><a href="global.html#unescapeUnicode">unescapeUnicode</a></li><li><a href="global.html#unescapeUnicodeExtended">unescapeUnicodeExtended</a></li><li><a href="global.html#unescapeUnicodeWithBrackets">unescapeUnicodeWithBrackets</a></li><li><a href="global.html#unindent">unindent</a></li><li><a href="global.html#walk">walk</a></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">TranslationSet.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/*
 * TranslationSet.js - a collection of resource strings
 *
 * Copyright Â© 2016-2017, 2019-2020 HealthTap, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

import log4js from "@log4js-node/log4js-api";

const logger = log4js.getLogger("tools-common.TranslationSet");

/**
 * @class A class that represents a set of translations used in
 * a project.
 *
 * @constructor
 * @param {String} sourceLocale the source locale for this set
 * @param {Object=} options options controlling this set
 */
class TranslationSet {
    constructor(sourceLocale) {
        this.sourceLocale = sourceLocale || "zxx-XX";

        this.resources = [];
        this.byHashKey = {};
        this.byCleanHashKey = {};
        this.dirty = false;
        this.stringsBySource = {};
        this.byResKey = {};
        this.resourceIndex = 0;
    }

    /**
     * Get a resource by its hashkey.
     *
     * @param {String} hashkey The unique hashkey of the resource being sought.
     * @returns {Resource|undefined} a resource corresponding to the hashkey, or undefined if there is no
     * resource with that key
     */
    get(hashkey) {
        logger.trace("Get a resource by hashkey " + hashkey);
        return this.byHashKey[hashkey];
    }

    /**
     * Get a resource by its clean string hashkey.
     *
     * @param {String} hashkey The unique hashkey of the resource being sought.
     * @returns {Resource|undefined} a resource corresponding to the hashkey, or undefined if there is no
     * resource with that key
     */
    getClean(hashkey) {
        logger.trace("Get a resource by clean hashkey " + hashkey);
        return this.byCleanHashKey[hashkey];
    }

    /**
     * Get a resource by its source string and context. The source string must be written
     * in the language and script of the source locale. For array types, the
     * source string
     * must be one of the values in the string array. For plural types, it
     * must be one of the values of the quantities.&lt;p>
     *
     * If the context is undefined,
     * this method will find the base generic resource with no context.
     *
     * @param {String} source The source string to look up
     * @param {String|undefined} context The optional context of the resource being sought.
     * @returns {Resource|undefined} a resource corresponding to the source string, or
     * undefined if there is no resource with that source
     */
    getBySource(source, context) {
        logger.trace("Get a resource by source");
        return this.stringsBySource[source + '@' + context];
    }

    /**
     * Return all resources in this set.
     *
     * @returns {Array.&lt;Resource>} an array of resources in this set,
     * possibly empty
     */
    getAll() {
        return this.resources;
    }

    /**
     * @private
     */
    addRes(resource, hashKey, cleanKey) {
        const existingClean = this.byCleanHashKey[cleanKey];

        logger.trace("New resource " + hashKey + " " + cleanKey);
        this.resources.push(resource);
        this.byHashKey[hashKey] = resource;
        if ( existingClean ){
            logger.trace("Overwrite cleanKey " + cleanKey);
        } else {
            logger.trace("New cleanKey " + cleanKey);
            this.byCleanHashKey[cleanKey] = resource;
        }
        this.dirty = true;

        if (resource.resType === "string" &amp;&amp; resource.autoKey) {
            this.stringsBySource[resource.getSource() + '@' + resource.context] = resource;
        }
    }

    /**
     * Add a resource to this set. If this resource has the same key
     * as an existing resource, but a different locale, then this
     * resource is added a translation instead.
     *
     * @param {Resource} resource a resource to add to this set
     */
    add(resource) {
        if (!resource) return;

        let existing;
        const key = resource.getKey(), hashKey = resource.hashKey();
        const cleanKey = resource.cleanHashKey();
        logger.trace("Add a resource. Hash: " + hashKey + " clean: " + cleanKey + " resource:" + JSON.stringify(resource));

        existing = this.byHashKey[hashKey];
        const existingClean = this.byCleanHashKey[cleanKey];

        if (existing) {
            logger.trace("Same key as existing resource: " + JSON.stringify(existing));
            if (existing.isInstance(resource)) {
                existing.addInstance(resource);
            } else if (resource.resType === "string") {
                if (resource.getSource() !== existing.getSource() ||
                        resource.getComment() !== existing.getComment() ||
                        resource.getState() !== existing.getState() ||
                        resource.getId() !== existing.getId()) {
                    logger.debug("Updating source");
                    logger.debug("Key: " + key);
                    logger.debug("Existing Source: " + existing.getSource() + "(" + existing.pathName + ")");
                    logger.debug("New Source: " + resource.getSource() + "(" + resource.pathName + ")");

                    resource = { ...resource, ...existing };
                    this.dirty = true;
                } else {
                    this.addRes(resource, hashKey, cleanKey);
                }
            }
        } else {
            this.addRes(resource, hashKey, cleanKey);
        }
    }

    /**
     * Add every resource in the given array to this set.
     * @param {Array.&lt;Resource>} resources an array of resources to add
     * to this set
     */
    addAll(resources) {
        if (resources &amp;&amp; resources.length) {
            resources.forEach(function(resource) {
                this.add(resource);
            }.bind(this));
        }
    }

    /**
     * Add every resource in the given translation set to this set,
     * merging the results together.
     *
     * @param {TranslationSet} set an set of resources to add
     * to this set
     */
    addSet(set) {
        if (set &amp;&amp; set.resources &amp;&amp; set.resources.length) {
            this.addAll(set.resources);
        } else {
            logger.trace("addSet: nothing to add");
        }
    }

    /**
     * Return the number of unique resources in this set.
     * @returns {number} the number of unique resources in this set
     */
    size() {
        return this.resources.length;
    }

    /**
     * Reset the dirty flag to false, meaning the set is clean. This will
     * allow callers to tell if any more resources were added after
     * this call was made because adding those resources will set
     * the dirty flag to true again.
     */
    setClean() {
        this.dirty = false;
    }

    /**
     * Return whether or not this set is dirty. The dirty flag is set
     * whenever a new resource was added to or removed from the set
     * after it was created or since the last time the setClean method
     * was called.
     * @return {boolean} true if the set is dirty, false otherwise
     */
    isDirty() {
        return this.dirty;
    }

    /**
     * Remove a resource from the set. The resource must have at
     * least enough fields specified to uniquely identify the
     * resource to remove. These are: project, context, locale,
     * resType, and reskey.
     *
     * @param {Resource} resource The resource to remove
     * @returns {boolean} true if the resource was removed successfully
     * and false otherwise
     */
    remove(resource) {
        let ret = false;

        if (resource &amp;&amp; resource.project &amp;&amp; resource.context &amp;&amp; resource.targetLocale &amp;&amp; resource.reskey &amp;&amp; resource.resType) {
            for (let i = 0; i &lt; this.resources.length; i++) {
                const res = this.resources[i];
                if (resource.project === res.project &amp;&amp;
                        resource.context == res.context &amp;&amp;
                        resource.getSourceLocale() === res.getSourceLocale() &amp;&amp;
                        resource.getTargetLocale() === res.getTargetLocale() &amp;&amp;
                        resource.getKey() === res.getKey()) {
                    const hashKey = resource.hashKey();
                    this.byHashKey[hashKey] = undefined;
                    if (resource.resType === "string") {
                        this.stringsBySource[res.getSource() + '@' + res.context] = undefined;
                    }
                    this.resources.splice(i, 1);
                    this.dirty = true;
                    ret = true;
                    break;
                }
            }
        } else {
            logger.warn("Invalid call to remove resource " + JSON.stringify(resource));
        }

        return ret;
    }

    /**
     * @private
     */
    _select(criteria) {
        const fields = Object.keys(criteria);

        return this.resources.filter(function(res) {
            return fields.every(function(field) {
                return Array.isArray(criteria[field]) ?
                    (criteria[field].length === 0 ||
                    criteria[field].some(function(value) {
                        return res[field] === value;
                    })) :
                    res[field] === criteria[field];
            });
        });
    }

    /**
     * Get a resource by the given criteria.
     * @param {Object} criteria the filter criteria to select the resources to return
     * @returns {Array.&lt;Resource>|undefined} the array of Resources, or undefined if the
     * retrieval did not find any resources that match or there was some error
     */
    getBy(options) {
        logger.trace("Getting resources by criteria");

        return this._select(options);
    }

    /**
     * Return an array of all the project names in the database.
     *
     * @returns {Array.&lt;String>|undefined} the array of project names
     * or undefined if there are no projects in the set
     */
    getProjects() {
        const set = new Set();

        this.resources.map(res => {
            set.add(res.getProject());
        });

        const projects = [ ... set.values() ];
        return projects.length ? projects : undefined;
    }

    /**
     * Return an array of all the contexts within the given project
     * in the set. The root context is just the empty string.
     * The root context is where all strings will go if they are
     * not given an explicit context in the resource file or code.
     *
     * @param {String|undefined} project the project that contains
     * the contexts or undefined to mean all projects
     * @returns {Array.&lt;String>|undefined} the array of context names
     * or undefined if there are no contexts in the set
     */
    getContexts(project) {
        const set = new Set();

        this.resources.map(res => {
            if (!project || res.getProject() === project) {
                const context = res.getContext();
                set.add(context ? context : "");
            }
        });

        const contexts = [ ... set.values() ];
        return contexts.length ? contexts : undefined;
    }

    /**
     * Return an array of all the locales available within the given
     * project and context in the set. The root context is just
     * the empty string. The locales are returned as BCP-47 locale
     * specs.
     *
     * @param {String|undefined} project the project that contains
     * the contexts or undefined to mean all projects
     * @param {String|undefined} context the context that contains
     * the locales or undefined to mean all locales.
     * Use the empty string "" for the default/root context.
     * @returns {Array.&lt;String>|undefined} the array of context names
     * or undefined if there are no contexts in the set
     */
    getLocales(project, context) {
        const set = new Set();

        this.resources.map(res => {
            if ((!project || res.getProject() === project) &amp;&amp; (!context || res.getContext() === context)) {
                set.add(res.getTargetLocale());
            }
        });

        const locales = [ ... set.values() ].sort();
        return locales.length ? locales : undefined;
    }

    /**
     * Clear all resources from this set.
     */
    clear() {
        this.resources = [];
        this.byHashKey = {};
        this.dirty = false;
        this.stringsBySource = {};
        this.byResKey = {};
    }

    /**
     * Return a new translation set that contains the differences
     * between the current set and the other set. Resources are
     * added to the difference set if they exist in the other
     * set but not the current one, or if they exist in both
     * sets, but contain different fields.
     *
     * @param {TranslationSet} other the other set to diff against
     * @returns {TranslationSet} the differences between the other
     * set and this one
     */
    diff(other) {
        const otherres = other.getAll();
        const diff = new TranslationSet(this.sourceLocale);
        let res, existing;

        for (let i = 0; i &lt; otherres.length; i++) {
            res = otherres[i];
            existing = this.byHashKey[res.hashKey()];

            if (!existing || !existing.equals(res)) {
                diff.add(res);
            }
        }

        return diff;
    }
}

export default TranslationSet;
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.4</a> on Mon Mar 03 2025 22:01:57 GMT-0800 (Pacific Standard Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
